<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Список заказов</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        .card {
            margin-top: 20px;
        }
    </style>
</head>

<body class="bg-light">
<header data-bs-theme="dark">
    <div class="navbar navbar-dark bg-dark shadow-sm">
        <div class="container">
            <a href="#" class="navbar-brand d-flex align-items-center">
                <img src="/static/CarWashLogo.jpg" width="60" height="60"/>
                <strong>&nbsp CarWash</strong>
            </a>
            <a href="/owneraccount" class="btn btn-outline-light ms-auto">Назад</a>
            <a href="/logout" class="btn btn-outline-light ms-auto">Выйти</a>
        </div>
    </div>
</header>

<main class="container py-4">
    <h1 class="h3 mb-3 fw-normal" th:text="${station.stationName}"></h1>
    <p class="mb-3">Адрес: <span th:text="${station.address}"></span></p>
    <p class="mb-3">Время работы: с <span th:text="${#dates.format(station.openTime, 'HH:mm')}"></span> до <span th:text="${#dates.format(station.closeTime, 'HH:mm')}"></span></p>

    <!-- Список заказов для текущей автомойки -->
    <h2 class="h4 mb-3">Заказы</h2>
    <div th:if="${station.orders.isEmpty()}">
        <p class="text-muted">Заказы отсутствуют.</p>
    </div>

    <div th:each="order : ${station.orders}">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Заказ #<span th:text="${order.id}"></span></h5>

                <!-- Форма для изменения статуса -->
                <form action="/order/updateStatus" method="post" class="d-flex align-items-center mb-3">
                    <input type="hidden" name="orderId" th:value="${order.id}">
                    <label for="status" class="form-label me-2">Статус:</label>
                    <select name="status" class="form-select w-auto me-2" required>
                        <option value="NEW" th:selected="${order.orderStatus == 'NEW'}">Новый</option>
                        <option value="IN_PROGRESS" th:selected="${order.orderStatus == 'IN_PROGRESS'}">В процессе</option>
                        <option value="COMPLETED" th:selected="${order.orderStatus == 'COMPLETED'}">Завершен</option>
                        <option value="CANCELLED" th:selected="${order.orderStatus == 'CANCELLED'}">Отменен</option>
                    </select>
                    <button type="submit" class="btn btn-primary btn-sm">Изменить статус</button>
                </form>

                <p class="card-text">Время начала: <span th:text="${#dates.format(order.startTime, 'dd-MM-yyyy HH:mm')}"></span></p>
                <p class="card-text">Время завершения: <span th:text="${#dates.format(order.endTime, 'dd-MM-yyyy HH:mm')}"></span></p>
                <p class="card-text">Дата заказа: <span th:text="${#dates.format(order.orderDate, 'dd-MM-yyyy')}"></span></p>
                <p class="card-text">Услуга: <span th:text="${order.service.name}"></span></p>
                <p class="card-text">Автомобиль: <span th:text="${order.car.make} + ' ' + ${order.car.model}"></span></p>
            </div>
        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
</body>
</html>
